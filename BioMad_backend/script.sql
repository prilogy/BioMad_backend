CREATE TABLE "Biomarkers" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    CONSTRAINT "PK_Biomarkers" PRIMARY KEY ("Id")
);

CREATE TABLE "Categories" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    CONSTRAINT "PK_Categories" PRIMARY KEY ("Id")
);

CREATE TABLE "BiomarkerTranslation" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "CultureId" integer NOT NULL,
    "Name" text NULL,
    "Description" text NULL,
    "BaseEntityId" integer NOT NULL,
    CONSTRAINT "PK_BiomarkerTranslation" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_BiomarkerTranslation_Biomarkers_BaseEntityId" FOREIGN KEY ("BaseEntityId") REFERENCES "Biomarkers" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_BiomarkerTranslation_Cultures_CultureId" FOREIGN KEY ("CultureId") REFERENCES "Cultures" ("Id") ON DELETE CASCADE
);

CREATE TABLE "CategoryBiomarker" (
    "CategoryId" integer NOT NULL,
    "BiomarkerId" integer NOT NULL,
    CONSTRAINT "PK_CategoryBiomarker" PRIMARY KEY ("BiomarkerId", "CategoryId"),
    CONSTRAINT "FK_CategoryBiomarker_Biomarkers_BiomarkerId" FOREIGN KEY ("BiomarkerId") REFERENCES "Biomarkers" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_CategoryBiomarker_Categories_CategoryId" FOREIGN KEY ("CategoryId") REFERENCES "Categories" ("Id") ON DELETE CASCADE
);

CREATE TABLE "CategoryTranslation" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "CultureId" integer NOT NULL,
    "Name" text NULL,
    "Description" text NULL,
    "BaseEntityId" integer NOT NULL,
    CONSTRAINT "PK_CategoryTranslation" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_CategoryTranslation_Categories_BaseEntityId" FOREIGN KEY ("BaseEntityId") REFERENCES "Categories" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_CategoryTranslation_Cultures_CultureId" FOREIGN KEY ("CultureId") REFERENCES "Cultures" ("Id") ON DELETE CASCADE
);

CREATE INDEX "IX_BiomarkerTranslation_BaseEntityId" ON "BiomarkerTranslation" ("BaseEntityId");

CREATE INDEX "IX_BiomarkerTranslation_CultureId" ON "BiomarkerTranslation" ("CultureId");

CREATE INDEX "IX_CategoryBiomarker_CategoryId" ON "CategoryBiomarker" ("CategoryId");

CREATE UNIQUE INDEX "IX_CategoryBiomarker_BiomarkerId_CategoryId" ON "CategoryBiomarker" ("BiomarkerId", "CategoryId");

CREATE INDEX "IX_CategoryTranslation_BaseEntityId" ON "CategoryTranslation" ("BaseEntityId");

CREATE INDEX "IX_CategoryTranslation_CultureId" ON "CategoryTranslation" ("CultureId");

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112105501_Fix', '3.1.9');

ALTER TABLE "Biomarkers" ADD "TypeId" integer NOT NULL DEFAULT 0;

CREATE TABLE "Articles" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    CONSTRAINT "PK_Articles" PRIMARY KEY ("Id")
);

CREATE TABLE "BiomarkerArticleTypes" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "Key" text NULL,
    CONSTRAINT "PK_BiomarkerArticleTypes" PRIMARY KEY ("Id")
);

CREATE TABLE "BiomarkerTypes" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    CONSTRAINT "PK_BiomarkerTypes" PRIMARY KEY ("Id")
);

CREATE TABLE "Units" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    CONSTRAINT "PK_Units" PRIMARY KEY ("Id")
);

CREATE TABLE "ArticleTranslation" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "CultureId" integer NOT NULL,
    "Name" text NULL,
    "Text" text NULL,
    "BaseEntityId" integer NOT NULL,
    CONSTRAINT "PK_ArticleTranslation" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_ArticleTranslation_Articles_BaseEntityId" FOREIGN KEY ("BaseEntityId") REFERENCES "Articles" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_ArticleTranslation_Cultures_CultureId" FOREIGN KEY ("CultureId") REFERENCES "Cultures" ("Id") ON DELETE CASCADE
);

CREATE TABLE "BiomarkerArticles" (
    "BiomarkerId" integer NOT NULL,
    "ArticleId" integer NOT NULL,
    "TypeId" integer NOT NULL,
    CONSTRAINT "PK_BiomarkerArticles" PRIMARY KEY ("TypeId", "ArticleId", "BiomarkerId"),
    CONSTRAINT "FK_BiomarkerArticles_Articles_ArticleId" FOREIGN KEY ("ArticleId") REFERENCES "Articles" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_BiomarkerArticles_Biomarkers_BiomarkerId" FOREIGN KEY ("BiomarkerId") REFERENCES "Biomarkers" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_BiomarkerArticles_BiomarkerArticleTypes_TypeId" FOREIGN KEY ("TypeId") REFERENCES "BiomarkerArticleTypes" ("Id") ON DELETE CASCADE
);

CREATE TABLE "BiomarkerTypeTranslation" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "CultureId" integer NOT NULL,
    "Name" text NULL,
    "Description" text NULL,
    "BaseEntityId" integer NOT NULL,
    CONSTRAINT "PK_BiomarkerTypeTranslation" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_BiomarkerTypeTranslation_BiomarkerTypes_BaseEntityId" FOREIGN KEY ("BaseEntityId") REFERENCES "BiomarkerTypes" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_BiomarkerTypeTranslation_Cultures_CultureId" FOREIGN KEY ("CultureId") REFERENCES "Cultures" ("Id") ON DELETE CASCADE
);

CREATE TABLE "BiomarkerUnit" (
    "BiomarkerId" integer NOT NULL,
    "UnitId" integer NOT NULL,
    CONSTRAINT "PK_BiomarkerUnit" PRIMARY KEY ("BiomarkerId", "UnitId"),
    CONSTRAINT "FK_BiomarkerUnit_Biomarkers_BiomarkerId" FOREIGN KEY ("BiomarkerId") REFERENCES "Biomarkers" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_BiomarkerUnit_Units_UnitId" FOREIGN KEY ("UnitId") REFERENCES "Units" ("Id") ON DELETE CASCADE
);

CREATE TABLE "UnitTranslation" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "CultureId" integer NOT NULL,
    "Name" text NULL,
    "BaseEntityId" integer NOT NULL,
    CONSTRAINT "PK_UnitTranslation" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_UnitTranslation_Units_BaseEntityId" FOREIGN KEY ("BaseEntityId") REFERENCES "Units" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_UnitTranslation_Cultures_CultureId" FOREIGN KEY ("CultureId") REFERENCES "Cultures" ("Id") ON DELETE CASCADE
);

CREATE INDEX "IX_Biomarkers_TypeId" ON "Biomarkers" ("TypeId");

CREATE INDEX "IX_ArticleTranslation_BaseEntityId" ON "ArticleTranslation" ("BaseEntityId");

CREATE INDEX "IX_ArticleTranslation_CultureId" ON "ArticleTranslation" ("CultureId");

CREATE INDEX "IX_BiomarkerArticles_ArticleId" ON "BiomarkerArticles" ("ArticleId");

CREATE INDEX "IX_BiomarkerArticles_BiomarkerId" ON "BiomarkerArticles" ("BiomarkerId");

CREATE UNIQUE INDEX "IX_BiomarkerArticles_TypeId_ArticleId_BiomarkerId" ON "BiomarkerArticles" ("TypeId", "ArticleId", "BiomarkerId");

CREATE INDEX "IX_BiomarkerTypeTranslation_BaseEntityId" ON "BiomarkerTypeTranslation" ("BaseEntityId");

CREATE INDEX "IX_BiomarkerTypeTranslation_CultureId" ON "BiomarkerTypeTranslation" ("CultureId");

CREATE INDEX "IX_BiomarkerUnit_UnitId" ON "BiomarkerUnit" ("UnitId");

CREATE INDEX "IX_UnitTranslation_BaseEntityId" ON "UnitTranslation" ("BaseEntityId");

CREATE INDEX "IX_UnitTranslation_CultureId" ON "UnitTranslation" ("CultureId");

ALTER TABLE "Biomarkers" ADD CONSTRAINT "FK_Biomarkers_BiomarkerTypes_TypeId" FOREIGN KEY ("TypeId") REFERENCES "BiomarkerTypes" ("Id") ON DELETE CASCADE;

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112121038_AddedAlotMore', '3.1.9');

ALTER TABLE "BiomarkerArticles" DROP CONSTRAINT "FK_BiomarkerArticles_BiomarkerArticleTypes_TypeId";

ALTER TABLE "BiomarkerArticleTypes" DROP CONSTRAINT "PK_BiomarkerArticleTypes";

ALTER TABLE "BiomarkerArticleTypes" RENAME TO "ArticleTypes";

ALTER TABLE "ArticleTypes" ADD "Discriminator" text NOT NULL DEFAULT '';

ALTER TABLE "ArticleTypes" ADD CONSTRAINT "PK_ArticleTypes" PRIMARY KEY ("Id");

ALTER TABLE "BiomarkerArticles" ADD CONSTRAINT "FK_BiomarkerArticles_ArticleTypes_TypeId" FOREIGN KEY ("TypeId") REFERENCES "ArticleTypes" ("Id") ON DELETE CASCADE;

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112123026_ArticleTypes', '3.1.9');

INSERT INTO "ArticleTypes" ("Id", "Discriminator", "Key")
VALUES (2, 'BiomarkerArticleType', 'decrease');
INSERT INTO "ArticleTypes" ("Id", "Discriminator", "Key")
VALUES (1, 'BiomarkerArticleType', 'increase');

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112123132_ArticleTypesAdded', '3.1.9');

ALTER TABLE "BiomarkerUnit" DROP CONSTRAINT "FK_BiomarkerUnit_Biomarkers_BiomarkerId";

ALTER TABLE "BiomarkerUnit" DROP CONSTRAINT "FK_BiomarkerUnit_Units_UnitId";

ALTER TABLE "BiomarkerUnit" DROP CONSTRAINT "PK_BiomarkerUnit";

ALTER TABLE "BiomarkerUnit" RENAME TO "BiomarkerUnits";

ALTER INDEX "IX_BiomarkerUnit_UnitId" RENAME TO "IX_BiomarkerUnits_UnitId";

ALTER TABLE "BiomarkerUnits" ADD CONSTRAINT "PK_BiomarkerUnits" PRIMARY KEY ("BiomarkerId", "UnitId");

CREATE TABLE "UnitTransfers" (
    "Id" integer NOT NULL GENERATED BY DEFAULT AS IDENTITY,
    "UnitAId" integer NOT NULL,
    "UnitBId" integer NOT NULL,
    "Coefficient" double precision NOT NULL,
    CONSTRAINT "PK_UnitTransfers" PRIMARY KEY ("Id"),
    CONSTRAINT "FK_UnitTransfers_Units_UnitAId" FOREIGN KEY ("UnitAId") REFERENCES "Units" ("Id") ON DELETE CASCADE,
    CONSTRAINT "FK_UnitTransfers_Units_UnitBId" FOREIGN KEY ("UnitBId") REFERENCES "Units" ("Id") ON DELETE CASCADE
);

CREATE INDEX "IX_UnitTransfers_UnitAId" ON "UnitTransfers" ("UnitAId");

CREATE INDEX "IX_UnitTransfers_UnitBId" ON "UnitTransfers" ("UnitBId");

ALTER TABLE "BiomarkerUnits" ADD CONSTRAINT "FK_BiomarkerUnits_Biomarkers_BiomarkerId" FOREIGN KEY ("BiomarkerId") REFERENCES "Biomarkers" ("Id") ON DELETE CASCADE;

ALTER TABLE "BiomarkerUnits" ADD CONSTRAINT "FK_BiomarkerUnits_Units_UnitId" FOREIGN KEY ("UnitId") REFERENCES "Units" ("Id") ON DELETE CASCADE;

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112142430_UnitTransfer', '3.1.9');

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112152550_NewlInk', '3.1.9');

INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20201112153704_SomeConfuig', '3.1.9');

